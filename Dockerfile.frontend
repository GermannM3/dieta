FROM node:18-alpine

WORKDIR /app

# Копируем package.json и устанавливаем зависимости
COPY calorie-love-tracker/package*.json ./
RUN npm ci --only=production

# Копируем исходный код
COPY calorie-love-tracker/ .

# Собираем приложение
RUN npm run build

# Устанавливаем nginx
RUN apk add --no-cache nginx

# Копируем nginx конфигурацию
COPY nginx.conf /etc/nginx/http.d/default.conf

# Открываем порт
EXPOSE 80

# Запускаем nginx
CMD ["nginx", "-g", "daemon off;"] 