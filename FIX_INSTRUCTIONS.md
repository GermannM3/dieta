# üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø—Ä–æ–±–ª–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx** - –∑–∞–º–µ–Ω–µ–Ω—ã `api:8000` –∏ `frontend:80` –Ω–∞ `127.0.0.1:8000` –∏ `127.0.0.1:3000`
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ .env
3. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ë–î** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `engine.begin()` –≤–º–µ—Å—Ç–æ `engine.connect()`
4. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ psutil** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è connections
5. **–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** - `test_services.py` –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

## üöÄ –ü–æ—à–∞–≥–æ–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

### 1. –ü–æ–ª—É—á–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```bash
git pull
```

### 2. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```bash
source venv/bin/activate
```

### 3. –û–±–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install --upgrade sqlalchemy asyncpg
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é nginx
```bash
sudo nginx -t
```

### 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ nginx
```bash
sudo systemctl reload nginx
```

### 6. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É
```bash
python diagnose.py
```

### 7. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å—ã –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
```bash
python test_services.py
```

### 8. –ï—Å–ª–∏ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
```bash
python start_all.py
```

## üîç –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):

### –¢–µ—Å—Ç API:
```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1
uvicorn improved_api_server:app --host 0.0.0.0 --port 8000 --reload
```

### –¢–µ—Å—Ç –±–æ—Ç–∞:
```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 2
python main.py
```

### –¢–µ—Å—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:
```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 3
cd calorie-love-tracker
npm start
```

## üåê –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

```bash
# API
curl http://localhost:8000/health

# –§—Ä–æ–Ω—Ç–µ–Ω–¥
curl -I http://localhost:3000

# –°–∞–π—Ç
curl -I http://tvoi-kalkulyator.ru
```

## üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è:

### 1. –û—à–∏–±–∫–∞ "host not found in upstream"
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –∑–∞–º–µ–Ω–µ–Ω—ã upstream –Ω–∞ 127.0.0.1

### 2. –û—à–∏–±–∫–∞ "AsyncConnection object does not support context manager"
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `engine.begin()` –≤–º–µ—Å—Ç–æ `engine.connect()`

### 3. –û—à–∏–±–∫–∞ "invalid attr name 'connections'"
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è connections –≤ psutil

### 4. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (TG_TOKEN –≤–º–µ—Å—Ç–æ BOT_TOKEN)

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

```bash
# –û–±—â–∏–π –ª–æ–≥
tail -f start_all.log

# –û—Ç–¥–µ–ª—å–Ω—ã–µ –ª–æ–≥–∏
tail -f logs/api.log
tail -f logs/frontend.log
tail -f logs/bot.log
tail -f /var/log/nginx/tvoi-kalkulyator.error.log
```

---

**–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –ø—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ! üéâ** 