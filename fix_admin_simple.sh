#!/bin/bash

echo "üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞ —á–µ—Ä–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä"
echo "==============================================="

# 1. –ü—Ä–æ–≤–µ—Ä–∏–º —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤..."
docker-compose -f docker-compose.fresh.yml ps

# 2. –ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ API –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
echo "üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É..."
if docker exec -it dieta-api-1 python --version 2>/dev/null; then
    echo "‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É —Ä–∞–±–æ—Ç–∞–µ—Ç"
    docker exec -it dieta-api-1 python fix_admin_complete.py
else
    echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É"
    echo "üîß –ü–æ–ø—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä..."
    
    # –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —Ç–µ–º–∏ –∂–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
    docker run --rm -it \
        --network dieta_app-network \
        -v $(pwd):/app \
        -w /app \
        --env-file .env \
        dieta-api \
        python fix_admin_complete.py
fi

echo "‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
echo "üîê –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞:"
echo "   Email: germannm@vk.com"
echo "   –ü–∞—Ä–æ–ª—å: admin123" 